import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import datetime

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
st.set_page_config(page_title="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç–∏—Å–∫—É –≥–∞–∑—É", layout="wide")

st.title("üìä –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∏—Å–∫—É –≤–∏–±—É—Ö—É –≥–∞–∑—É")
st.info("""**–°—Ü–µ–Ω–∞—Ä—ñ–π:** –ù–∞ —Ç–µ—Ä–∏—Ç–æ—Ä—ñ—ó —Ä–µ–∑–µ—Ä–≤—É–∞—Ä–Ω–æ–≥–æ –ø–∞—Ä–∫—É —Å–∫–ª–∞–¥—É —Å—Ç–∏—Å–Ω–µ–Ω–∏—Ö –≥–∞–∑—ñ–≤ –≤—ñ–¥–±—É–ª–∞—Å—è —Ä–æ–∑–≥–µ—Ä–º–µ—Ç–∏–∑–∞—Ü—ñ—è —Ä–µ–∑–µ—Ä–≤—É–∞—Ä—É —ñ–∑ –ø–æ–¥–∞–ª—å—à–∏–º –≤–∏–±—É—Ö–æ–º –≥–∞–∑—É. –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ—á–æ–≤–∏–Ω–∏ —Ç–∞ —ó—ó –≤–∏–¥ –Ω–∞–≤–µ–¥–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—è—Ö 1, 2. \n\n""" 
"""***–ó–∞–≤–¥–∞–Ω–Ω—è:*** –ù–∞–Ω–µ—Å—Ç–∏ —Ä–∞–¥—ñ—É—Å–∏ —É—Ä–∞–∂–µ–Ω—å –Ω–∞ –ø–ª–∞–Ω —Ä–µ–∑–µ—Ä–≤—É–∞—Ä—É –Ω–∞ –º—ñ—Å—Ü–µ–≤–æ—Å—Ç—ñ. –î–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—ñ–≤, –¥—ñ–∞–º–µ—Ç—Ä —Ä–µ–∑–µ—Ä–≤—É–∞—Ä—É —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 10 –º. 
–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –Ω–∞–¥–ª–∏—à–∫–æ–≤–æ–≥–æ —Ç–∏—Å–∫—É –≤–∏–±—É—Ö—É –ø—Ä–∏ –≤–∏–∫–∏–¥—ñ —Å—Ç–∏—Å–Ω–µ–Ω–æ–≥–æ –≥–∞–∑—É –∑–∞ –∑–∞–¥–∞–Ω–∏—Ö —É–º–æ–≤. –ü–æ–∑–Ω–∞—á–∏—Ç–∏ —Ä–∞–¥—ñ—É—Å–∏ –º–µ–∂ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å ‚àÜP (100, 50, 30, 20, 5 –∫–ü–∞).""")

GasVolume = [
    [5594, 2728, 3212, 9341, 5356, 9815, 5159, 9814, 8458, 4318],
    [4250, 5879, 2480, 8136, 5212, 2975, 7152, 6883, 8223, 6450],
    [9980, 4200, 6041, 3059, 7159, 5537, 9131, 4077, 6490, 9562],
    [1139, 5203, 6479, 7937, 2977, 9638, 3735, 9387, 1526, 6212],
    [9661, 7284, 2928, 2574, 2636, 6029, 9820, 2141, 1546, 1607],
    [4786, 7186, 6589, 3190, 8046, 2576, 8048, 4810, 8702, 7145],
    [3263, 1760, 7726, 1794, 6437, 8302, 2462, 4217, 3333, 8561],
    [2978, 6547, 1782, 4815, 5312, 7625, 8005, 6378, 2798, 2840],
    [7263, 2812, 8916, 8532, 3887, 6228, 3664, 8257, 3838, 4215],
    [6102, 4176, 7044, 7019, 4027, 3317, 9798, 9315, 3898, 4628]
]

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –∑ –ø—ñ–¥–ø–∏—Å–∞–º–∏ –æ—Å–µ–π
df_m_table = pd.DataFrame(
    data, 
    index=[f"–û—Å—Ç. —Ü–∏—Ñ—Ä–∞ {i}" for i in range(10)], 
    columns=[f"–ü–µ—Ä–µ–¥ –æ—Å—Ç. {i}" for i in range(10)]
)

# –í–∏–≤—ñ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞ —Ç–∞–±–ª–∏—Ü—ñ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É
st.markdown("### –¢–∞–±–ª–∏—Ü—è 1. –û–±‚Äô—î–º –≥–æ—Ä—é—á–æ–≥–æ –≥–∞–∑—É [$V$], —â–æ –ø—Ä–∏–π–º–∞—î —É—á–∞—Å—Ç—å —É –≤–∏–±—É—Ö—É [–º3]")
st.write("–ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –ø–µ—Ä–µ—Ç–∏–Ω—ñ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó —Ç–∞ –ø–µ—Ä–µ–¥–æ—Å—Ç–∞–Ω–Ω—å–æ—ó —Ü–∏—Ñ—Ä –≤–∞—à–æ–≥–æ –Ω–æ–º–µ—Ä–∞:")

# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ dataframe –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É (–º–æ–∂–Ω–∞ —Å–æ—Ä—Ç—É–≤–∞—Ç–∏ –∞–±–æ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏)
st.dataframe(df_m_table, use_container_width=True)

# 4. –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ
st.table(df_m_table)

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å–∞–º–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –∑ –¥–∞–Ω–∏–º–∏ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤)
st.dataframe(df, use_container_width=True)

# –í–∏–≤—ñ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞ —Ç–∞–±–ª–∏—Ü—ñ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É
st.markdown("### –¢–∞–±–ª–∏—Ü—è 1. –û–±‚Äô—î–º –≥–æ—Ä—é—á–æ–≥–æ –≥–∞–∑—É [$V$], —â–æ –ø—Ä–∏–π–º–∞—î —É—á–∞—Å—Ç—å —É –≤–∏–±—É—Ö—É [–º3]")
st.write("–ó–Ω–∞–π–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –ø–µ—Ä–µ—Ç–∏–Ω—ñ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó —Ç–∞ –ø–µ—Ä–µ–¥–æ—Å—Ç–∞–Ω–Ω—å–æ—ó —Ü–∏—Ñ—Ä –≤–∞—à–æ–≥–æ –Ω–æ–º–µ—Ä–∞:")

# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ dataframe –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É (–º–æ–∂–Ω–∞ —Å–æ—Ä—Ç—É–≤–∞—Ç–∏ –∞–±–æ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏)
st.dataframe(df_m_table, use_container_width=True)

st.write("–í–≤–µ–¥—ñ—Ç—å —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –±—ñ—á–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫ –Ω–∞–¥–ª–∏—à–∫–æ–≤–æ–≥–æ —Ç–∏—Å–∫—É –≤–∏–±—É—Ö—É –¥–ª—è –≤–∞—à–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä—ñ—é.")


# –°—Ç–≤–æ—Ä—é—î–º–æ –±—ñ—á–Ω—É –ø–∞–Ω–µ–ª—å (Sidebar) –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
with st.sidebar:
    st.header("–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ")
    m = st.number_input("–ú–∞—Å–∞ (m), –∫–≥", value=10.0, step=1.0)
    z = st.number_input("–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç (z)", value=0.1, step=0.01, format="%.2f")
    Q_gas_val = st.number_input("–¢–µ–ø–ª–æ—Ç–∞ –∑–≥–æ—Ä—è–Ω–Ω—è —Ä–µ—á–æ–≤–∏–Ω–∏ Q_gas (x10^6), –î–∂/–∫–≥", value=5.1, step=0.1)
    
    # –§—ñ–∑–∏—á–Ω—ñ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏
    Q0 = 4.52 * 10**6
    P0 = 101.3

# –í–∏–∫–æ–Ω—É—î–º–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏
Q_gas = Q_gas_val * 10**6
m_pr = (Q_gas * m * z) / Q0

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É m_pr –∑–≤–µ—Ä—Ö—É
st.metric(label="–†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–µ m_pr", value=f"{m_pr:.2f}")

# –î–∞–Ω—ñ –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞
r = np.linspace(5, 200, 500)
# –£–Ω–∏–∫–∞—î–º–æ –¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ –Ω—É–ª—å, —è–∫—â–æ r –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ 0
P = P0 * (0.8 * m_pr**0.33 / r + 3 * m_pr**0.66 / r**2 + 5 * m_pr / r**3)

# –°—Ç–≤–æ—Ä—é—î–º–æ –¥–∞–Ω—ñ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ –≥—Ä–∞–Ω–∏—á–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
damage_data = {
    "–¢–∏—Å–∫ (–∫–ü–∞)": ["2-5", "5-10", "10-20", "20-30", "30-50", "50-100", "> 100"],
    "–§—ñ–∑–∏—á–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏ —Ç–∞ —Ä—É–π–Ω—É–≤–∞–Ω–Ω—è": [
        "–î–∑–≤—ñ–Ω —Å–∫–ª–∞, –º–æ–∂–ª–∏–≤–µ —Ä–æ–∑–±–∏—Ç—Ç—è –≤—ñ–∫–æ–Ω",
        "–ü–æ–º—ñ—Ä–Ω—ñ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –≤—ñ–∫–æ–Ω–Ω–∏—Ö —Ä–∞–º",
        "–¢—Ä—ñ—â–∏–Ω–∏ –≤ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–∫–∞—Ö, —Ä—É–π–Ω—É–≤–∞–Ω–Ω—è —à–∏–±–æ–∫",
        "–ß–∞—Å—Ç–∫–æ–≤–µ —Ä—É–π–Ω—É–≤–∞–Ω–Ω—è –Ω–µ–∂–∏—Ç–ª–æ–≤–∏—Ö –±—É–¥—ñ–≤–µ–ª—å",
        "–†—É–π–Ω—É–≤–∞–Ω–Ω—è —Ü–µ–≥–ª—è–Ω–∏—Ö —Å—Ç—ñ–Ω, –∑–Ω–∞—á–Ω—ñ –ø–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –¥–∞—Ö—ñ–≤",
        "–ü–æ–≤–Ω–µ —Ä—É–π–Ω—É–≤–∞–Ω–Ω—è —Å—Ç—ñ–Ω –±—É–¥—ñ–≤–µ–ª—å, –∑–∞–≥—Ä–æ–∑–∞ –∂–∏—Ç—Ç—é",
        "–ü–æ–≤–Ω–µ —Ä—É–π–Ω—É–≤–∞–Ω–Ω—è —Å–ø–æ—Ä—É–¥, –ª–µ—Ç–∞–ª—å–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏"
    ]
}

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞ —Ç–∞–±–ª–∏—Ü—ñ
st.subheader("‚ö†Ô∏è –ì—Ä–∞–Ω–∏—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏—Å–∫—É —Ç–∞ –Ω–∞—Å–ª—ñ–¥–∫–∏")
st.table(damage_data)

# –ü–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Matplotlib
fig, ax = plt.subplots(figsize=(10, 5))
ax.plot(r, P, label=f"P(r) –ø—Ä–∏ m={m}", color='#1f77b4', lw=2.5)

# –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏—Ö –ª—ñ–Ω—ñ–π (5, 20, 30, 50, 100)
for val in [5, 10, 20, 50, 100]:
    ax.axhline(y=val, color='red', linestyle='--', alpha=0.3)

ax.set_ylim(0, 110)
ax.set_xlim(0, 200)
ax.set_xlabel('–í—ñ–¥—Å—Ç–∞–Ω—å r, –º')
ax.set_ylabel('–¢–∏—Å–∫ P, –∫–ü–∞')
ax.grid(True, which='both', linestyle=':', alpha=0.5)
ax.legend()

# –í–∏–≤—ñ–¥ –≥—Ä–∞—Ñ—ñ–∫–∞ –Ω–∞ –≤–µ–±—Å—Ç–æ—Ä—ñ–Ω–∫—É
st.pyplot(fig)

# –û—Ç—Ä–∏–º—É—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Ä—ñ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
current_year = datetime.datetime.now().year

# –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∞–≤—Ç–æ—Ä—Å—å–∫–∏—Ö –ø—Ä–∞–≤ —É —Ñ—É—Ç–µ—Ä—ñ
st.markdown("---") 
st.markdown(f"<p style='text-align: center; color: gray;'><small>¬© {current_year} Kostiantyn Afanasenko. –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</small></p>", unsafe_allow_html=True)










